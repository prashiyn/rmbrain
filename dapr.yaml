version: 1

# Multi-app Dapr configuration for all microservices
# This file centralizes all Dapr application configurations
# Components are defined in /dapr/components
# Global config is defined in /dapr/config

apps:
  # BFF Service
  - appID: bff-service
    appDirPath: ./bff_service
    command: ["uv", "run", "python", "-m", "uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
    appPort: 8000
    daprHTTPPort: 3500
    daprGRPCPort: 60001
    logLevel: info
    enableMetrics: true
    enableAPILogging: true
    componentsPath: ./dapr/components
    config: ./dapr/config/global-config.yaml
    env:
      APP_ID: "bff-service"
      APP_PORT: "8000"
      DAPR_HTTP_PORT: "3500"
      DAPR_GRPC_PORT: "60001"
      LOG_LEVEL: "INFO"
      DAPR_PUBSUB_NAME: "pubsub"

  # CAS Audit Service
  - appID: cas-audit
    appDirPath: ./cas_service
    command: ["uv", "run", "python", "-m", "uvicorn", "cas_audit.main:app", "--host", "0.0.0.0", "--port", "8001"]
    appPort: 8001
    daprHTTPPort: 3501
    daprGRPCPort: 60002
    logLevel: info
    enableMetrics: true
    enableAPILogging: true
    componentsPath: ./dapr/components
    config: ./dapr/config/global-config.yaml
    env:
      APP_ID: "cas-audit"
      APP_PORT: "8001"
      DAPR_HTTP_PORT: "3501"
      DAPR_GRPC_PORT: "60002"
      LOG_LEVEL: "INFO"
      DAPR_PUBSUB_NAME: "pubsub"
      DAPR_TOPIC: "audit-events"
      DATABASE_URL: "postgresql://postgres:postgres@localhost:5432/cas_audit"

  # Client Service
  - appID: cds-client
    appDirPath: ./client_service
    command: ["uv", "run", "python", "-m", "uvicorn", "cds_client.main:app", "--host", "0.0.0.0", "--port", "8002"]
    appPort: 8002
    daprHTTPPort: 3502
    daprGRPCPort: 60003
    logLevel: info
    enableMetrics: true
    enableAPILogging: true
    componentsPath: ./dapr/components
    config: ./dapr/config/global-config.yaml
    env:
      APP_ID: "cds-client"
      APP_PORT: "8002"
      DAPR_HTTP_PORT: "3502"
      DAPR_GRPC_PORT: "60003"
      LOG_LEVEL: "INFO"
      DAPR_PUBSUB_NAME: "pubsub"
      DATABASE_URL: "postgresql://postgres:postgres@localhost:5432/cds_client"

  # Document Service
  - appID: cds-document
    appDirPath: ./document_service
    command: ["uv", "run", "python", "-m", "uvicorn", "cds_document.api:app", "--host", "0.0.0.0", "--port", "8003"]
    appPort: 8003
    daprHTTPPort: 3503
    daprGRPCPort: 60004
    logLevel: info
    enableMetrics: true
    enableAPILogging: true
    componentsPath: ./dapr/components
    config: ./dapr/config/global-config.yaml
    env:
      APP_ID: "cds-document"
      APP_PORT: "8003"
      DAPR_HTTP_PORT: "3503"
      DAPR_GRPC_PORT: "60004"
      LOG_LEVEL: "INFO"
      DAPR_PUBSUB_NAME: "pubsub"
      DATABASE_URL: "postgresql://postgres:postgres@localhost:5432/cds_document"

  # Interaction Service
  - appID: cds-interaction
    appDirPath: ./interaction_service
    command: ["uv", "run", "python", "-m", "uvicorn", "cds_interaction.app.main:app", "--host", "0.0.0.0", "--port", "8004"]
    appPort: 8004
    daprHTTPPort: 3504
    daprGRPCPort: 60005
    logLevel: info
    enableMetrics: true
    enableAPILogging: true
    componentsPath: ./dapr/components
    config: ./dapr/config/global-config.yaml
    env:
      APP_ID: "cds-interaction"
      APP_PORT: "8004"
      DAPR_HTTP_PORT: "3504"
      DAPR_GRPC_PORT: "60005"
      LOG_LEVEL: "INFO"
      DAPR_PUBSUB_NAME: "pubsub"
      DATABASE_URL: "postgresql+asyncpg://postgres:postgres@localhost:5432/interaction_db"

  # Policy Service
  - appID: cps-policy
    appDirPath: ./policy_service
    command: ["uv", "run", "python", "-m", "uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8005"]
    appPort: 8005
    daprHTTPPort: 3505
    daprGRPCPort: 60006
    logLevel: info
    enableMetrics: true
    enableAPILogging: true
    componentsPath: ./dapr/components
    config: ./dapr/config/global-config.yaml
    env:
      APP_ID: "cps-policy"
      APP_PORT: "8005"
      DAPR_HTTP_PORT: "3505"
      DAPR_GRPC_PORT: "60006"
      LOG_LEVEL: "INFO"
      DAPR_PUBSUB_NAME: "rmbrain-pubsub"
      CPS_APP_PORT: "8005"
      CPS_DAPR_PORT: "3505"
      CPS_DAPR_GRPC_PORT: "60006"

  # Product Service
  - appID: cds-product
    appDirPath: ./product_service
    command: ["uv", "run", "python", "-m", "uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8006"]
    appPort: 8006
    daprHTTPPort: 3506
    daprGRPCPort: 60007
    logLevel: info
    enableMetrics: true
    enableAPILogging: true
    componentsPath: ./dapr/components
    config: ./dapr/config/global-config.yaml
    env:
      APP_ID: "cds-product"
      APP_PORT: "8006"
      DAPR_HTTP_PORT: "3506"
      DAPR_GRPC_PORT: "60007"
      LOG_LEVEL: "INFO"
      PUBSUB_NAME: "rmbrain-pubsub"
      PRODUCT_TOPIC: "rb.product"
      DATABASE_URL: "postgresql://postgres:postgres@localhost:5432/cds_product"

  # Relationship Service
  - appID: cds-relationship
    appDirPath: ./relationship_service
    command: ["uv", "run", "python", "-m", "uvicorn", "cds_relationship.main:app", "--host", "0.0.0.0", "--port", "8007"]
    appPort: 8007
    daprHTTPPort: 3507
    daprGRPCPort: 60008
    logLevel: info
    enableMetrics: true
    enableAPILogging: true
    componentsPath: ./dapr/components
    config: ./dapr/config/global-config.yaml
    env:
      APP_ID: "cds-relationship"
      APP_PORT: "8007"
      DAPR_HTTP_PORT: "3507"
      DAPR_GRPC_PORT: "60008"
      LOG_LEVEL: "INFO"
      DAPR_PUBSUB_NAME: "pubsub"
      DATABASE_URL: "postgresql://postgres:postgres@localhost:5432/relationship_db"

  # Risk Profile Service
  - appID: cds-riskprofile
    appDirPath: ./riskprofile_service
    command: ["uv", "run", "python", "-m", "uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8008"]
    appPort: 8008
    daprHTTPPort: 3508
    daprGRPCPort: 60009
    logLevel: info
    enableMetrics: true
    enableAPILogging: true
    componentsPath: ./dapr/components
    config: ./dapr/config/global-config.yaml
    env:
      APP_ID: "cds-riskprofile"
      APP_PORT: "8008"
      DAPR_HTTP_PORT: "3508"
      DAPR_GRPC_PORT: "60009"
      LOG_LEVEL: "INFO"
      DAPR_PUBSUB_NAME: "rmbrain-pubsub"
      DATABASE_URL: "postgresql://postgres:postgres@localhost:5432/riskprofile_db"

  # RMBrain Main App
  - appID: rmbrain-mainapp
    appDirPath: ./rmbrain-mainapp
    command: ["uv", "run", "python", "-m", "uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8009"]
    appPort: 8009
    daprHTTPPort: 3509
    daprGRPCPort: 60010
    logLevel: info
    enableMetrics: true
    enableAPILogging: true
    componentsPath: ./dapr/components
    config: ./dapr/config/global-config.yaml
    env:
      APP_ID: "rmbrain-mainapp"
      APP_PORT: "8009"
      DAPR_HTTP_PORT: "3509"
      DAPR_GRPC_PORT: "60010"
      LOG_LEVEL: "INFO"
      DAPR_PUBSUB_NAME: "pubsub"
      DATABASE_URL: "postgresql+asyncpg://postgres:postgres@localhost:5432/rmbrain_mainapp"

  # Task Service
  - appID: cds-task
    appDirPath: ./task_service
    command: ["uv", "run", "python", "-m", "uvicorn", "cds_task.main:app", "--host", "0.0.0.0", "--port", "8010"]
    appPort: 8010
    daprHTTPPort: 3510
    daprGRPCPort: 60011
    logLevel: info
    enableMetrics: true
    enableAPILogging: true
    componentsPath: ./dapr/components
    config: ./dapr/config/global-config.yaml
    env:
      APP_ID: "cds-task"
      APP_PORT: "8010"
      DAPR_HTTP_PORT: "3510"
      DAPR_GRPC_PORT: "60011"
      LOG_LEVEL: "INFO"
      DAPR_PUBSUB_NAME: "pubsub"
      DATABASE_URL: "postgresql+asyncpg://postgres:postgres@localhost:5432/cds_task"

# Note: Global configurations are defined in ./dapr/config/
# Note: Database URLs in this file are development defaults. For production, use .env files in each service directory.
# Each app references the config file directly via the 'config' field above

